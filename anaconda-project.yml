name: ipyelk

variables:
  ELK_SRC: >-
    setup.py ipyelk postBuild scripts

commands:
  setup:
    description: do what binder does
    unix: &setup python postBuild
    windows: *setup

  watch:
    description: set up processes for live development
    unix: &watch python scripts/watch.py
    windows: *watch

  lab:
    description: launch lab
    unix: &lab jupyter lab --no-browser --debug
    windows: *lab

  lint:
    description: apply source formatting
    unix: isort -rc $ELK_SRC && black $ELK_SRC && jlpm lint
    windows: isort -rc %ELK_SRC% && black %ELK_SRC% && jlpm lint

  dist:
    description: build distributions
    unix: &dist python setup.py bdist_wheel sdist && cd dist && npm pack ..
    windows: *dist

env_specs:
  default:
    platforms:
      - linux-64
      - osx-64
      - win-64
    inherit_from:
      - ipyelk
    packages:
      - black
      - isort <5
      - python =3.7

  ipyelk:
    description: binder environment
    channels:
      - anaconda
      - conda-forge
      - msys2
    packages:
      - ipywidgets >=7.5.1
      - jupyterlab >=1.2,<1.3.0a0
      - networkx
      - nodejs >=10,<14.0.0a0
      - pandas
      - python >=3.7
      - ipython >=7
